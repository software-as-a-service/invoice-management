<section>
    <div id=toolbar__ID>
        <a id=back__ID>Back</a> <a id=pv__ID >Print</a>
    </div>

    <div id=pvdiv__ID>
        <form id=fm__ID>
            <div id=tbdiv style='padding:20px'>
                <table id=table_form_noborder__ID style='width:800px;'>
                <colgroup><col style='width:550px' /><col style='width:100px' /><col /></colgroup>
                <tr><td  style='font-size:200%' >Wappsystem PTY LTD</td><td colspan=2 style='font-size:300%;'>Tax Invoice</td></tr>
                <tr><td>27 Creekwood Drive</td><td  style='font-size:150%;' >No.</td><td style='font-size:150%;' ><label id=invoice_number__ID></label></td></tr>
                <tr><td>Voyager Point NSW 2172</td><td></td><td></td></tr>
                <tr><td>Email:wappsystem@gmail.com</td><td></td><td></td></tr>
                <tr><td>ABN: 86152510980</td><td  style='font-weight:bold' >Issue Date</td><td style='font-weight:bold' ><label id=issue_date__ID></label></td></tr>
                <tr><td>Account Name: Wappsystem Pty Ltd</td><td></td><td></td></tr>
                <tr><td>BSB: 112-879</td><td></td><td></td></tr>
                <tr><td>Acount No.: 466817733</td><td></td><td></td></tr>
                <tr><td>&nbsp;</td><td></td><td></td></tr>
                <tr><td class=subheader_l__ID>To</td><td></td><td></td></tr>
                <tr><td><label id=client__ID style='font-size:120%;'></label></td><td></td><td>&nbsp;</td></tr>
                <tr><td><label id=client_address1__ID></label></td><td></td><td>&nbsp;</td></tr>
                <tr><td><label id=client_address2__ID></label></td><td></td><td>&nbsp;</td></tr>
                <tr><td><label id=client_address3__ID></label></td><td></td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td></td><td></td></tr>
                <tr><td>&nbsp;</td><td></td><td></td></tr>

                </table>
                <table id=table_form1__ID  style='width:800px;'>
                    <colgroup><col style='width:450px' /><col style='width:50px'  /><col style='width:50px'   /><col style='width:120px'   /><col /></colgroup>
                        <tr ><td class=subheader_l__ID >Item/Description</td><td class=subheader_m__ID>GST</td><td class=subheader_m__ID>Qty</td><td class=subheader_r__ID>Unit Price</td><td class=subheader_r__ID>Sub Total</td></tr>
                        <tr><td class=text_l__ID><label id=item_line0__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line0__ID></label></td><td class=text_m__ID><label id=qty_line0__ID></label></td><td class=text_r__ID__ID><label id=price_line0__ID></label></td><td class=text_r__ID><label id=total_line0__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line1__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line1__ID></label></td><td class=text_m__ID><label id=qty_line1__ID></label></td><td class=text_r__ID__ID><label id=price_line1__ID></label></td><td class=text_r__ID><label id=total_line1__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line2__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line2__ID></label></td><td class=text_m__ID><label id=qty_line2__ID></label></td><td class=text_r__ID__ID><label id=price_line2__ID></label></td><td class=text_r__ID><label id=total_line2__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line3__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line3__ID></label></td><td class=text_m__ID><label id=qty_line3__ID></label></td><td class=text_r__ID__ID><label id=price_line3__ID></label></td><td class=text_r__ID><label id=total_line3__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line4__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line4__ID></label></td><td class=text_m__ID><label id=qty_line4__ID></label></td><td class=text_r__ID__ID><label id=price_line4__ID></label></td><td class=text_r__ID><label id=total_line4__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line5__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line5__ID></label></td><td class=text_m__ID><label id=qty_line5__ID></label></td><td class=text_r__ID__ID><label id=price_line5__ID></label></td><td class=text_r__ID><label id=total_line5__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line6__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line6__ID></label></td><td class=text_m__ID><label id=qty_line6__ID></label></td><td class=text_r__ID__ID><label id=price_line6__ID></label></td><td class=text_r__ID><label id=total_line6__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line7__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line7__ID></label></td><td class=text_m__ID><label id=qty_line7__ID></label></td><td class=text_r__ID__ID><label id=price_line7__ID></label></td><td class=text_r__ID><label id=total_line7__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line8__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line8__ID></label></td><td class=text_m__ID><label id=qty_line8__ID></label></td><td class=text_r__ID__ID><label id=price_line8__ID></label></td><td class=text_r__ID><label id=total_line8__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line9__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line9__ID></label></td><td class=text_m__ID><label id=qty_line9__ID></label></td><td class=text_r__ID__ID><label id=price_line9__ID></label></td><td class=text_r__ID><label id=total_line9__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line10__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line10__ID></label></td><td class=text_m__ID><label id=qty_line10__ID></label></td><td class=text_r__ID__ID><label id=price_line10__ID></label></td><td class=text_r__ID><label id=total_line10__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line11__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line11__ID></label></td><td class=text_m__ID><label id=qty_line11__ID></label></td><td class=text_r__ID__ID><label id=price_line11__ID></label></td><td class=text_r__ID><label id=total_line11__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line12__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line12__ID></label></td><td class=text_m__ID><label id=qty_line12__ID></label></td><td class=text_r__ID__ID><label id=price_line12__ID></label></td><td class=text_r__ID><label id=total_line12__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line13__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line13__ID></label></td><td class=text_m__ID><label id=qty_line13__ID></label></td><td class=text_r__ID__ID><label id=price_line13__ID></label></td><td class=text_r__ID><label id=total_line13__ID></label></td></tr>
                        <tr><td class=text_l__ID><label id=item_line14__ID></label>&nbsp;</td><td class=text_m__ID><label id=gst_line14__ID></label></td><td class=text_m__ID><label id=qty_line14__ID></label></td><td class=text_r__ID__ID><label id=price_line14__ID></label></td><td class=text_r__ID><label id=total_line14__ID></label></td></tr>
                </table>
                 <table id=table_form_noborder__ID style='width:800px;'>
                <colgroup><col style='width:550px' /><col style='width:220px' /><col /></colgroup>
                    <tr><td></td><td  style='font-size:120%;text-align:right' >Total without GST</td><td style='font-size:120%;text-align:right' ><label id=sub_total__ID></label></td></tr>
                    <tr><td></td><td  style='font-size:120%;text-align:right' >GST</td><td style='font-size:120%;text-align:right' ><label id=gst__ID></label></td></tr>
                    <tr><td></td><td  style='font-size:150%;text-align:right' >TOTAL</td><td style='font-size:150%;text-align:right' ><label id=total__ID></label></td></tr>
                    <tr><td></td><td>&nbsp;</td><td></td></tr>
                    <tr><td></td><td  style='font-size:120%;text-align:right' >Please pay by</td><td style='font-size:120%;text-align:right' ><label id=pay_by__ID ></label></td></tr>
                </table>
            </div>
        </form>
    </div>
</section>
<script>
    function F__ID(){
        //---------------------------------------------
        VmInclude:__BASE__/vmiis/Common-Code/toolbar/back_and_print.js
    	//---------------------------------------------
    	$('#D__ID').on('load',function(){
            //-----------------------------------------
            //clear
            $('#D__ID label').each(function(){
                $(this).text('');
            })
            //-----------------------------------------
            //get invoice
            var invoice_pid=$vm.module_list['invoice'][0];
            var invoice_uid=$vm.vm['__ID'].op.invoice_uid;
            var sql="select Information,PUID,V1,V2,V12=V1-V2 from [TABLE-"+invoice_pid+"] where uid="+invoice_uid;
            var req={cmd:'query_records',sql:sql}
            $VmAPI.request({data:req,callback:function(res){
                var records=res.records;
                if(records.length>0){
                    $('#invoice_number__ID').text(invoice_uid);
                    if(records[0].Issue_Date!==undefined) $('#issue_date__ID').text(records[0].Issue_Date);
                    if(records[0].Due_Date!==undefined) $('#pay_by__ID').text(records[0].Due_Date);
                    if(records[0].V12!==undefined) $('#sub_total__ID').text('$'+parseFloat(records[0].V12).toFixed(2));
                    if(records[0].V2!==undefined) $('#gst__ID').text('$'+parseFloat(records[0].V2).toFixed(2));
                    if(records[0].V1!==undefined) $('#total__ID').text('$'+parseFloat(records[0].V1).toFixed(2));
                    //-----------------------------------------
                    //get client
                    var client_uid=records[0].PUID;
                    var client_pid=$vm.module_list['client'][0];
                    sql="select Information from [TABLE-"+client_pid+"] where uid="+client_uid;
                    req={cmd:'query_records',sql:sql}
                    $VmAPI.request({data:req,callback:function(res){
                        var sub_records=res.records;
                        if(sub_records.length>0){
                            if(sub_records[0].Address!==undefined) $('#client_address1__ID').text(sub_records[0].Address);
                            if(sub_records[0].Client_Name!==undefined) $('#client__ID').text(sub_records[0].Client_Name);
                            if(sub_records[0].Address!==undefined) $('#client_address1__ID').text(sub_records[0].Address);
                        }
                    }})
                    //-----------------------------------------
                    //get invoice items
                    var invoice_items_pid=$vm.module_list['invoice_item'][0];
                    var invoice_items_puid=invoice_uid;
                    sql="select Information from [TABLE-"+invoice_items_pid+"] where puid="+invoice_items_puid;
                    req={cmd:'query_records',sql:sql}
                    $VmAPI.request({data:req,callback:function(res){
                        var sub_records=res.records;
                        for(var i=0;i<sub_records.length;i++){
                            if(sub_records[i].i1Description!==undefined) $('#item_line'+i+'__ID').text(sub_records[i].i1Description);
                            if(sub_records[i].i1GST!==undefined){
                                if(sub_records[i].i1GST=='on' || sub_records[i].i1GST=='1' || sub_records[i].i1GST===true || sub_records[i].i1GST=='True') $('#gst_line'+i+'__ID').text('Yes');
                                else $('#gst_line'+i+'__ID').text('No');
                            }
                            if(sub_records[i].i1Qty!==undefined)        $('#qty_line'+i+'__ID').text(sub_records[i].i1Qty);
                            if(sub_records[i].i1Price!==undefined)      $('#price_line'+i+'__ID').text('$'+sub_records[i].i1Price);
                            if(sub_records[i].i1Sub_Total!==undefined)  $('#total_line'+i+'__ID').text('$'+parseFloat(sub_records[i].i1Sub_Total).toFixed(2) );
                        }
                    }})
                    //-----------------------------------------
                }

            }})
    	});
    	//---------------------------------------------
    }
</script>
<style>
    VmInclude:__BASE__/vmiis/Common-Code/toolbar/toolbar_for_excel.css
    #D__ID,#D__ID table,#pvdiv__ID table{
        font-size:10pt;
        font-family: Verdana,Helvetica,Arial,sans-serif;;
    }
    .subheader_l__ID{text-align:left!Important;font-size:12px;font-weight:bold;background-color:#aaa;}
    .subheader_m__ID{text-align:center!Important;font-size:12px;font-weight:bold;background-color:#aaa;vertical-align:middle!important;}
    .subheader_r__ID{text-align:right!Important;font-size:12px;font-weight:bold;background-color:#aaa;vertical-align:middle!important;}
    .text_l__ID{text-align:left!Important;vertical-align:middle!important;}
    .text_m__ID{text-align:center!Important;vertical-align:middle!important;}
    .text_r__ID{text-align:right!Important;vertical-align:middle!important;}
    #table_form_noborder__ID {width:100%;font-size:9pt; font-family:Verdana; margin:0; border-spacing:0; border-collapse: collapse; table-layout: auto;}
    #table_form_noborder__ID td{vertical-align:bottom; border: 0 #069 solid; color: #333; border-collapse: collapse; text-align: left; padding: 1px;padding-right:4px;}
    #table_form1__ID {border: 3px #000 solid;font-size:9pt;font-family:Verdana;border-spacing:0;border-collapse: collapse; table-layout: automatic;}
    #table_form1__ID td{ border: 1px #000 solid;}
    #table_form1__ID td:first-child{padding:3px;}
    .item_footer__ID{width:800px;font-size:9pt; font-family:Verdana;text-align:right;padding-top:3px;padding-right:0px;}
</style>
